import math


class WeightMap:
    """Default weights for imvu base male avatar.

    """
    wmap = {"Female03MasterRoot": 0,
            "PelvisNode": 1,
            "lfHip": 2,
            "lfThigh": 3,
            "lfCalf": 4,
            "lfFoot": 5,
            "lfToes": 6,

            "rtHip": 8,
            "rtThigh": 9,
            "rtCalf": 10,
            "rtFoot": 11,
            "rtToes": 12,

            "Spine01": 14,
            "Spine02": 15,
            "Spine03": 16,
            "Spine04": 17,

            "Neck01": 18,
            "Neck02": 19,
            "Neck03": 20,
            "Neck04": 21,
            "Head": 22,

            "lfClavicle": 24,
            "lfShoulder": 25,
            "lfBicep": 26,
            "lfElbow": 27,
            "lfWrist": 28,
            "lfHand": 29,

            "lfmetaCarpal03": 30,
            "lfFingerMiddle01": 31,
            "lfFingerMiddle02": 32,
            "lfFingerMiddle03": 33,

            "lfmetaCarpal01": 35,
            "lfThumb01": 36,
            "lfThumb02": 37,
            "lfThumb03": 38,
            "lfmetaCarpal05": 40,

            "lfFingerPinky01": 41,
            "lfFingerPinky02": 42,
            "lfFingerPinky03": 43,
            "lfmetaCarpal02": 45,

            "lfFingerIndex01": 46,
            "lfFingerIndex02": 47,
            "lfFingerIndex03": 48,
            "lfmetaCarpal04": 50,

            "lfFingerRing01": 51,
            "lfFingerRing02": 52,
            "lfFingerRing03": 53,
            "rtClavicle": 55,
            "rtShoulder": 56,

            "rtBicep": 57,
            "rtElbow": 58,
            "rtWrist": 59,
            "rtHand": 60,
            "rtmetaCarpal03": 61,
            "rtFingerMiddle01": 62,

            "rtFingerMiddle02": 63,
            "rtFingerMiddle03": 64,
            "rtmetaCarpal01": 66,
            "rtThumb01": 67,
            "rtThumb02": 68,

            "rtThumb03": 69,
            "rtmetaCarpal05": 71,
            "rtFingerPinky01": 72,
            "rtFingerPinky02": 73,
            "rtFingerPinky03": 74,

            "rtmetaCarpal02": 76,
            "rtFingerIndex01": 77,
            "rtFingerIndex02": 78,
            "rtFingerIndex03": 79,

            "rtmetaCarpal04": 81,
            "rtFingerRing01": 82,
            "rtFingerRing02": 83,
            "rtFingerRing03": 84}

    pmap = {'PelvisNode': [0.0, 0.08434296399354935, 6.638940811157227],
            'lfHip': [0.2815685272216797, -0.0160521250218153, 6.478870868682861],
            'lfThigh': [0.520327627658844, 0.019918274134397507, 5.073301792144775],
            'lfCalf': [0.48931223154067993, 0.20753031969070435, 2.369795083999634],
            'lfFoot': [0.5051766633987427, 0.049632664769887924, 0.7215731739997864],
            'lfToes': [0.5091897249221802, -0.6217567920684814, 0.3721778988838196],

            'rtHip': [-0.27885425090789795, -0.01605198159813881, 6.478870868682861],
            'rtThigh': [-0.5198215246200562, 0.019869502633810043, 5.073480129241943],
            'rtCalf': [-0.4934576451778412, 0.20741227269172668, 2.370084762573242],
            'rtFoot': [-0.5125235319137573, 0.04956559091806412, 0.7218267917633057],
            'rtToes': [-0.5209792852401733, -0.6218152642250061, 0.3724704086780548],

            'Spine01': [0.0034651621244847775, -0.020602861419320107, 7.0536885261535645],
            'Spine02': [0.003466390073299408, -0.09204048663377762, 7.4901227951049805],
            'Spine03': [0.003471922129392624, -0.1449018120765686, 8.02203369140625],
            'Spine04': [0.0034135067835450172, -0.02939564920961857, 8.734273910522461],

            'Neck01': [0.0034857108257710934, 0.11252973973751068, 9.28950023651123],
            'Neck02': [0.0034875930286943913, 0.11220824718475342, 9.45449447631836],
            'Neck03': [0.0034901034086942673, 0.11843866109848022, 9.598451614379883],
            'Neck04': [0.0034911311231553555, 0.12373086810112, 9.772016525268555],
            'Head': [0.0034893620759248734, 0.1227593645453453, 10.060586929321289],

            'lfClavicle': [0.5816829204559326, 0.07901491969823837, 9.079941749572754],
            'lfShoulder': [1.2340643405914307, 0.05890588462352753, 8.985596656799316],
            'lfBicep': [1.9188063144683838, 0.05484580993652344, 8.675603866577148],
            'lfElbow': [2.963886260986328, -0.028262417763471603, 8.240041732788086],
            'lfWrist': [3.6275954246520996, -0.15035977959632874, 7.9686055183410645],
            'lfHand': [3.9262609481811523, -0.20859791338443756, 7.836241245269775],

            'lfmetaCarpal03': [4.262717247009277, -0.29849597811698914, 7.704916954040527],
            'lfFingerMiddle01': [4.644565582275391, -0.39229869842529297, 7.523123741149902],
            'lfFingerMiddle02': [4.836702346801758, -0.4207404851913452, 7.364534378051758],
            'lfFingerMiddle03': [4.9711737632751465, -0.43145889043807983, 7.186041831970215],

            'lfmetaCarpal01': [3.9835944175720215, -0.3266682028770447, 7.762567520141602],
            'lfThumb01': [4.025911331176758, -0.4744706451892853, 7.64926290512085],
            'lfThumb02': [4.1437835693359375, -0.5909488201141357, 7.503446578979492],
            'lfThumb03': [4.252396583557129, -0.7113857269287109, 7.352869033813477],

            'lfmetaCarpal05': [4.266029357910156, -0.18150818347930908, 7.703486442565918],
            'lfFingerPinky01': [4.6242218017578125, -0.1427876204252243, 7.539496421813965],
            'lfFingerPinky02': [4.770355701446533, -0.14681380987167358, 7.4171671867370605],
            'lfFingerPinky03': [4.873884677886963, -0.15284709632396698, 7.266836166381836],

            'lfmetaCarpal02': [4.243794918060303, -0.36348485946655273, 7.693711757659912],
            'lfFingerIndex01': [4.581328392028809, -0.532348096370697, 7.508725643157959],
            'lfFingerIndex02': [4.720218658447266, -0.5670784711837769, 7.3563032150268555],
            'lfFingerIndex03': [4.809359550476074, -0.5783108472824097, 7.19183349609375],

            'lfmetaCarpal04': [4.273469924926758, -0.23658576607704163, 7.705625057220459],
            'lfFingerRing01': [4.660773754119873, -0.2604709565639496, 7.53589391708374],
            'lfFingerRing02': [4.839893817901611, -0.2772235870361328, 7.39577054977417],
            'lfFingerRing03': [4.968732833862305, -0.28662049770355225, 7.237359523773193],

            'rtClavicle': [-0.5751109719276428, 0.07901573181152344, 9.079943656921387],
            'rtShoulder': [-1.2274928092956543, 0.0589071586728096, 8.985601425170898],
            'rtBicep': [-1.9110801219940186, 0.058598823845386505, 8.673552513122559],
            'rtElbow': [-2.960399627685547, 0.0029225233010947704, 8.243612289428711],
            'rtWrist': [-3.659641981124878, -0.09724705666303635, 7.987279415130615],
            'rtHand': [-3.9824116230010986, -0.15316341817378998, 7.8662614822387695],

            'rtmetaCarpal03': [-4.326448917388916, -0.23109659552574158, 7.739613056182861],
            'rtFingerMiddle01': [-4.723895072937012, -0.3130183219909668, 7.560786724090576],
            'rtFingerMiddle02': [-4.919824600219727, -0.33484238386154175, 7.40589714050293],
            'rtFingerMiddle03': [-5.057924270629883, -0.34107857942581177, 7.229963779449463],

            'rtmetaCarpal01': [-4.036423206329346, -0.2676507830619812, 7.797059059143066],
            'rtThumb01': [-4.081115245819092, -0.4129275977611542, 7.687784194946289],
            'rtThumb02': [-4.198859214782715, -0.5229130983352661, 7.549802780151367],
            'rtThumb03': [-4.307512283325195, -0.6372552514076233, 7.406553745269775],

            'rtmetaCarpal05': [-4.323769569396973, -0.1018703430891037, 7.738522529602051],
            'rtFingerPinky01': [-4.689687252044678, -0.036505647003650665, 7.577589988708496],
            'rtFingerPinky02': [-4.836422443389893, -0.029418569058179855, 7.458531379699707],
            'rtFingerPinky03': [-4.9415178298950195, -0.02699577622115612, 7.310572624206543],

            'rtmetaCarpal02': [-4.306234359741211, -0.30396199226379395, 7.727288246154785],
            'rtFingerIndex01': [-4.656865119934082, -0.47154462337493896, 7.54365348815918],
            'rtFingerIndex02': [-4.797216892242432, -0.5045323371887207, 7.393895626068115],
            'rtFingerIndex03': [-4.887874126434326, -0.5150520205497742, 7.231103420257568],

            'rtmetaCarpal04': [-4.335432052612305, -0.16172471642494202, 7.741222381591797],
            'rtFingerRing01': [-4.736135959625244, -0.1638927161693573, 7.575389385223389],
            'rtFingerRing02': [-4.918427467346191, -0.1700693964958191, 7.438946723937988],
            'rtFingerRing03': [-5.050625324249268, -0.17158883810043335, 7.283175468444824]}

    @classmethod
    def get_bone_id(cls, bone_name):
        """Maps an imvu bone to its body part id.

        Args:
            bone_name (str): A string representing the name of an imvu bone.

        Returns:
            An int referring to the bone's body part id.

        """
        return cls.wmap[bone_name]

    @classmethod
    def get_bone(cls, loc) -> str:
        curr_bone = 0
        curr_dist = float("inf")
        for key, val in cls.pmap.items():
            dist = math.sqrt(((loc[0] - val[0]) ** 2) + ((loc[1] - val[1]) ** 2) + ((loc[2] - val[2]) ** 2))
            if dist < curr_dist:
                curr_dist = dist
                curr_bone = cls.wmap[key]
        return str(curr_bone)